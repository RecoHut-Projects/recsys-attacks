
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Black-box Attack API &#8212; recsys-attacks</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Black-box Attack on Sequential Recs" href="T355514_Black_box_Attack_on_Sequential_Recs.html" />
    <link rel="prev" title="Data Poisoning Attack using LFM and ItemAE on Synthetic Dataset" href="T711285_Data_Poisoning_Attack_using_LFM_and_ItemAE_on_Synthetic_Dataset.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">recsys-attacks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="US026046_Attacks_on_Recommender_Systems.html">
   Attacks on Recommender Systems
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Attack models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="C361387_DPADL.html">
   DPADL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C900563_AUSH.html">
   AUSH
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C378133_TAaMR.html">
   TAaMR
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C826054_Adversarial.html">
   Adversarial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="C999743_BASR.html">
   BASR
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="T006054_SDLib.html">
   SDLib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T865035_Simulating_Data_Poisoning_Attacks_against_Twitter_Recommender.html">
   Simulating Data Poisoning Attacks against Twitter Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T081831_Data_Poisoning_Attacks_on_Factorization_Based_Collaborative_Filtering.html">
   Data Poisoning Attacks on Factorization-Based Collaborative Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T711285_Data_Poisoning_Attack_using_LFM_and_ItemAE_on_Synthetic_Dataset.html">
   Data Poisoning Attack using LFM and ItemAE on Synthetic Dataset
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Black-box Attack API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T355514_Black_box_Attack_on_Sequential_Recs.html">
   Black-box Attack on Sequential Recs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T102448_Adversarial_Learning_for_Recommendation.html">
   Adversarial Training (Regularization) on a Recommender System
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/T697871_Black_box_Attack_API.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sparsh-ai/recsys-attacks/main?urlpath=lab/tree/docs/T697871_Black_box_Attack_API.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/sparsh-ai/recsys-attacks/blob/main/docs/T697871_Black_box_Attack_API.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#black-box-model-training">
   Black-Box Model Training
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#white-box-model-distillation">
   White-Box Model Distillation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#attack">
   Attack
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrain">
   Retrain
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="black-box-attack-api">
<h1>Black-box Attack API<a class="headerlink" href="#black-box-attack-api" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!git clone https://github.com/Yueeeeeeee/RecSys-Extraction-Attack.git
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning into &#39;RecSys-Extraction-Attack&#39;...
remote: Enumerating objects: 77, done.
remote: Counting objects: 100% (77/77), done.
remote: Compressing objects: 100% (58/58), done.
remote: Total 77 (delta 25), reused 66 (delta 19), pack-reused 0
Unpacking objects: 100% (77/77), done.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">cd</span> <span class="n">RecSys</span><span class="o">-</span><span class="n">Extraction</span><span class="o">-</span><span class="n">Attack</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/content/RecSys-Extraction-Attack
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!apt-get install libarchive-dev
!pip install faiss-cpu --no-cache
!apt-get install libomp-dev
!pip install wget
!pip install libarchive
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">zero_gradients</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">detach_</span><span class="p">()</span>
            <span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">zero_gradients</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="black-box-model-training">
<h2>Black-Box Model Training<a class="headerlink" href="#black-box-model-training" title="Permalink to this headline">¶</a></h2>
<p><strong>NARM model trained on ML-1M dataset.</strong></p>
<p>Given a user sequence 𝒙 with length 𝑇 , we use <span class="math notranslate nohighlight">\(𝒙_{[:𝑇−2]}\)</span> as training data and use the last two items for validation and testing respectively. We use hyper-parameters from grid-search. Additionally, all models are trained using Adam optimizer with weight decay 0.01, learning rate 0.001, batch size 128 and 100 linear warmup steps, allowed sequence length as 200.</p>
<p>We accelerate evaluation by uniformly sampling 100 negative items for each user. Then we rank them with the positive item and report the average performance on these 101 testing items. Our Evaluation focuses on two aspects:</p>
<ul class="simple">
<li><p>Ranking Performance: We to use truncated Recall&#64;K that is equivalent to Hit Rate (HR&#64;K) in our evaluation, and Normalized Discounted Cumulative Gain (NDCG&#64;K) to measure the ranking quality.</p></li>
<li><p>Agreement Measure: We define Agreement&#64;K (Agr&#64;K) to evaluate the output similarity between the black-box model and our extracted white-box model.</p></li>
</ul>
<p>Official results:</p>
<img src='_images/T697871_1.png'><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python train.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input 1 / 20 for movielens, b for beauty, bd for dense beauty, g for games, s for steam and y for yoochoose: 1
Input model code, b for BERT, s for SASRec and n for NARM: n
Input GPU ID: 0
Raw file doesn&#39;t exist. Downloading...

Extracting data...

/content/RecSys-Extraction-Attack/datasets/ml_1m.py:87: ParserWarning: Falling back to the &#39;python&#39; engine because the &#39;c&#39; engine does not support regex separators (separators &gt; 1 char and different from &#39;\s+&#39; are interpreted as regex); you can avoid this warning by specifying engine=&#39;python&#39;.
  df = pd.read_csv(file_path, sep=&#39;::&#39;, header=None)
Filtering triplets
Densifying index
Splitting
100% 6040/6040 [00:08&lt;00:00, 685.31it/s]
Negative samples don&#39;t exist. Generating.
Sampling negative items randomly...
100% 6040/6040 [00:01&lt;00:00, 5988.52it/s]
Negative samples don&#39;t exist. Generating.
Sampling negative items randomly...
100% 6040/6040 [00:01&lt;00:00, 5951.72it/s]
Failed to load old model, continue training new model...
Eval: N@1 0.008, N@5 0.028, N@10 0.048, R@1 0.008, R@5 0.049, R@10 0.111: 100% 48/48 [00:02&lt;00:00, 21.95it/s]
Update Best NDCG@10 Model at 1
Epoch 1, loss 6.354 : 100% 7668/7668 [11:07&lt;00:00, 11.50it/s]
Eval: N@1 0.355, N@5 0.530, N@10 0.567, R@1 0.355, R@5 0.683, R@10 0.796: 100% 48/48 [00:01&lt;00:00, 30.64it/s]
Update Best NDCG@10 Model at 1
Epoch 2, loss 5.663 : 100% 7668/7668 [11:06&lt;00:00, 11.51it/s]
Eval: N@1 0.422, N@5 0.588, N@10 0.619, R@1 0.422, R@5 0.730, R@10 0.826: 100% 48/48 [00:01&lt;00:00, 29.94it/s]
Update Best NDCG@10 Model at 2
Epoch 3, loss 5.485 : 100% 7668/7668 [11:06&lt;00:00, 11.50it/s]
Eval: N@1 0.442, N@5 0.604, N@10 0.636, R@1 0.442, R@5 0.742, R@10 0.840: 100% 48/48 [00:01&lt;00:00, 30.34it/s]
Update Best NDCG@10 Model at 3
Epoch 4, loss 5.398 : 100% 7668/7668 [11:07&lt;00:00, 11.49it/s]
Eval: N@1 0.451, N@5 0.614, N@10 0.644, R@1 0.451, R@5 0.752, R@10 0.843: 100% 48/48 [00:01&lt;00:00, 30.18it/s]
Update Best NDCG@10 Model at 4
Epoch 5, loss 5.342 : 100% 7668/7668 [11:09&lt;00:00, 11.45it/s]
Eval: N@1 0.457, N@5 0.621, N@10 0.648, R@1 0.457, R@5 0.759, R@10 0.842: 100% 48/48 [00:01&lt;00:00, 30.07it/s]
Update Best NDCG@10 Model at 5
Epoch 6, loss 5.302 : 100% 7668/7668 [11:08&lt;00:00, 11.48it/s]
Eval: N@1 0.460, N@5 0.621, N@10 0.649, R@1 0.460, R@5 0.756, R@10 0.841: 100% 48/48 [00:01&lt;00:00, 30.67it/s]
Update Best NDCG@10 Model at 6
Epoch 7, loss 5.273 : 100% 7668/7668 [11:09&lt;00:00, 11.45it/s]
Eval: N@1 0.456, N@5 0.620, N@10 0.648, R@1 0.456, R@5 0.758, R@10 0.844: 100% 48/48 [00:01&lt;00:00, 30.36it/s]
Epoch 8, loss 5.251 : 100% 7668/7668 [11:08&lt;00:00, 11.47it/s]
Eval: N@1 0.473, N@5 0.629, N@10 0.656, R@1 0.473, R@5 0.761, R@10 0.844: 100% 48/48 [00:01&lt;00:00, 30.63it/s]
Update Best NDCG@10 Model at 8
Epoch 9, loss 5.234 : 100% 7668/7668 [11:09&lt;00:00, 11.46it/s]
Eval: N@1 0.470, N@5 0.626, N@10 0.654, R@1 0.470, R@5 0.759, R@10 0.844: 100% 48/48 [00:01&lt;00:00, 30.18it/s]
Epoch 10, loss 5.220 : 100% 7668/7668 [11:10&lt;00:00, 11.43it/s]
Eval: N@1 0.467, N@5 0.627, N@10 0.654, R@1 0.467, R@5 0.763, R@10 0.846: 100% 48/48 [00:01&lt;00:00, 30.24it/s]
Epoch 11, loss 5.209 : 100% 7668/7668 [11:12&lt;00:00, 11.40it/s]
Eval: N@1 0.471, N@5 0.630, N@10 0.658, R@1 0.471, R@5 0.766, R@10 0.851: 100% 48/48 [00:01&lt;00:00, 29.42it/s]
Update Best NDCG@10 Model at 11
Epoch 12, loss 5.199 : 100% 7668/7668 [11:13&lt;00:00, 11.39it/s]
Eval: N@1 0.478, N@5 0.634, N@10 0.661, R@1 0.478, R@5 0.766, R@10 0.850: 100% 48/48 [00:01&lt;00:00, 29.94it/s]
Update Best NDCG@10 Model at 12
Epoch 13, loss 5.190 : 100% 7668/7668 [11:13&lt;00:00, 11.38it/s]
Eval: N@1 0.473, N@5 0.631, N@10 0.658, R@1 0.473, R@5 0.763, R@10 0.847: 100% 48/48 [00:01&lt;00:00, 29.89it/s]
Epoch 14, loss 5.181 : 100% 7668/7668 [11:13&lt;00:00, 11.38it/s]
Eval: N@1 0.478, N@5 0.636, N@10 0.661, R@1 0.478, R@5 0.767, R@10 0.845: 100% 48/48 [00:01&lt;00:00, 29.68it/s]
Epoch 15, loss 5.175 : 100% 7668/7668 [11:13&lt;00:00, 11.38it/s]
Eval: N@1 0.474, N@5 0.630, N@10 0.658, R@1 0.474, R@5 0.761, R@10 0.845: 100% 48/48 [00:01&lt;00:00, 29.58it/s]
Epoch 16, loss 5.170 : 100% 7668/7668 [11:13&lt;00:00, 11.38it/s]
Eval: N@1 0.468, N@5 0.629, N@10 0.655, R@1 0.468, R@5 0.764, R@10 0.845: 100% 48/48 [00:01&lt;00:00, 30.33it/s]
Epoch 17, loss 5.164 : 100% 7668/7668 [11:13&lt;00:00, 11.38it/s]
Eval: N@1 0.471, N@5 0.630, N@10 0.657, R@1 0.471, R@5 0.765, R@10 0.848: 100% 48/48 [00:01&lt;00:00, 29.70it/s]
Epoch 18, loss 5.160 : 100% 7668/7668 [11:13&lt;00:00, 11.39it/s]
Eval: N@1 0.478, N@5 0.634, N@10 0.660, R@1 0.478, R@5 0.765, R@10 0.846: 100% 48/48 [00:01&lt;00:00, 29.59it/s]
Epoch 19, loss 5.156 : 100% 7668/7668 [11:12&lt;00:00, 11.40it/s]
Eval: N@1 0.473, N@5 0.631, N@10 0.658, R@1 0.473, R@5 0.765, R@10 0.847: 100% 48/48 [00:01&lt;00:00, 29.04it/s]
Epoch 20, loss 5.152 : 100% 7668/7668 [11:10&lt;00:00, 11.44it/s]
Eval: N@1 0.477, N@5 0.631, N@10 0.658, R@1 0.477, R@5 0.763, R@10 0.845: 100% 48/48 [00:01&lt;00:00, 30.32it/s]
Epoch 21, loss 5.143 :  79% 6039/7668 [08:45&lt;02:21, 11.48it/s]
Traceback (most recent call last):
  File &quot;train.py&quot;, line 52, in &lt;module&gt;
    train(args, resume=True)
  File &quot;train.py&quot;, line 40, in train
    trainer.train()
  File &quot;/content/RecSys-Extraction-Attack/trainer/narm.py&quot;, line 57, in train
    accum_iter = self.train_one_epoch(epoch, accum_iter)        
  File &quot;/content/RecSys-Extraction-Attack/trainer/narm.py&quot;, line 78, in train_one_epoch
    loss.backward()
  File &quot;/usr/local/lib/python3.7/dist-packages/torch/_tensor.py&quot;, line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File &quot;/usr/local/lib/python3.7/dist-packages/torch/autograd/__init__.py&quot;, line 149, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># !zip -r bb_model_narm_ml1m.zip ./experiments</span>
<span class="c1"># !cp bb_model_narm_ml1m.zip /content/drive/MyDrive/TempData</span>
<span class="c1"># !ls /content/drive/MyDrive/TempData</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="white-box-model-distillation">
<h2>White-Box Model Distillation<a class="headerlink" href="#white-box-model-distillation" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!cp /content/drive/MyDrive/TempData/bb_model_narm_ml1m.zip .
!unzip bb_model_narm_ml1m.zip
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Archive:  bb_model_narm_ml1m.zip
   creating: experiments/
   creating: experiments/narm/
   creating: experiments/narm/ml-1m/
   creating: experiments/narm/ml-1m/logs/
  inflating: experiments/narm/ml-1m/logs/events.out.tfevents.1631975614.0dbd3d97f40f.706.0  
   creating: experiments/narm/ml-1m/models/
  inflating: experiments/narm/ml-1m/models/best_acc_model.pth  
  inflating: experiments/narm/ml-1m/models/checkpoint-recent.pth  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python distill.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input 1 / 20 for movielens, b for beauty, bd for dense beauty, g for games, s for steam and y for yoochoose: 1
Input model code, b for BERT, s for SASRec and n for NARM: n
Input GPU ID: 0
Already preprocessed. Skip preprocessing
Negatives samples exist. Loading.
Negatives samples exist. Loading.
Input black box model code, b for BERT, s for SASRec and n for NARM: n
Input integer number of seqs budget: 4
Generating dataset...
100% 60/60 [01:40&lt;00:00,  1.68s/it]
## Distilling model via autoregressive data... ##
Eval: N@1 0.007, N@5 0.027, N@10 0.043, R@1 0.007, R@5 0.048, R@10 0.100: 100% 24/24 [00:00&lt;00:00, 24.84it/s]
Update Best NDCG@10 Model at 1
  0% 0/4665 [00:00&lt;?, ?it/s]/usr/local/lib/python3.7/dist-packages/torch/distributions/distribution.py:151: UserWarning: sample_n will be deprecated. Use .sample((n,)) instead
  warnings.warn(&#39;sample_n will be deprecated. Use .sample((n,)) instead&#39;, UserWarning)
Epoch 1 Stage 1, loss 0.548 : 100% 4665/4665 [07:58&lt;00:00,  9.75it/s]
Eval: N@1 0.341, N@5 0.543, N@10 0.584, R@1 0.341, R@5 0.725, R@10 0.851: 100% 24/24 [00:00&lt;00:00, 31.03it/s]
Update Best NDCG@10 Model at 1
Epoch 2 Stage 1, loss 0.510 : 100% 4665/4665 [07:58&lt;00:00,  9.76it/s]
Eval: N@1 0.465, N@5 0.668, N@10 0.697, R@1 0.465, R@5 0.844, R@10 0.935: 100% 24/24 [00:00&lt;00:00, 31.01it/s]
Update Best NDCG@10 Model at 2
Epoch 3 Stage 1, loss 0.504 : 100% 4665/4665 [07:58&lt;00:00,  9.76it/s]
Eval: N@1 0.514, N@5 0.721, N@10 0.746, R@1 0.514, R@5 0.896, R@10 0.970: 100% 24/24 [00:00&lt;00:00, 31.54it/s]
Update Best NDCG@10 Model at 3
Epoch 4 Stage 1, loss 0.502 : 100% 4665/4665 [07:58&lt;00:00,  9.75it/s]
Eval: N@1 0.544, N@5 0.748, N@10 0.768, R@1 0.544, R@5 0.918, R@10 0.978: 100% 24/24 [00:00&lt;00:00, 31.56it/s]
Update Best NDCG@10 Model at 4
Epoch 5 Stage 1, loss 0.501 : 100% 4665/4665 [07:57&lt;00:00,  9.77it/s]
Eval: N@1 0.567, N@5 0.762, N@10 0.781, R@1 0.567, R@5 0.926, R@10 0.981: 100% 24/24 [00:00&lt;00:00, 31.42it/s]
Update Best NDCG@10 Model at 5
Epoch 6 Stage 1, loss 0.500 : 100% 4665/4665 [07:57&lt;00:00,  9.76it/s]
Eval: N@1 0.575, N@5 0.771, N@10 0.789, R@1 0.575, R@5 0.930, R@10 0.985: 100% 24/24 [00:00&lt;00:00, 30.58it/s]
Update Best NDCG@10 Model at 6
Epoch 7 Stage 1, loss 0.499 : 100% 4665/4665 [07:56&lt;00:00,  9.79it/s]
Eval: N@1 0.580, N@5 0.779, N@10 0.796, R@1 0.580, R@5 0.940, R@10 0.991: 100% 24/24 [00:00&lt;00:00, 30.56it/s]
Update Best NDCG@10 Model at 7
Epoch 8 Stage 1, loss 0.499 : 100% 4665/4665 [07:59&lt;00:00,  9.72it/s]
Eval: N@1 0.583, N@5 0.785, N@10 0.799, R@1 0.583, R@5 0.947, R@10 0.992: 100% 24/24 [00:00&lt;00:00, 30.84it/s]
Update Best NDCG@10 Model at 8
Epoch 9 Stage 1, loss 0.498 : 100% 4665/4665 [07:54&lt;00:00,  9.82it/s]
Eval: N@1 0.599, N@5 0.788, N@10 0.804, R@1 0.599, R@5 0.942, R@10 0.989: 100% 24/24 [00:00&lt;00:00, 32.05it/s]
Update Best NDCG@10 Model at 9
Epoch 10 Stage 1, loss 0.498 : 100% 4665/4665 [07:56&lt;00:00,  9.79it/s]
Eval: N@1 0.597, N@5 0.791, N@10 0.805, R@1 0.597, R@5 0.948, R@10 0.989: 100% 24/24 [00:00&lt;00:00, 30.99it/s]
Update Best NDCG@10 Model at 10
Epoch 11 Stage 1, loss 0.498 :  27% 1249/4665 [02:07&lt;05:49,  9.79it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!zip -r wb_model_narm_ml1m.zip ./experiments
!cp wb_model_narm_ml1m.zip /content/drive/MyDrive/TempData
!ls /content/drive/MyDrive/TempData
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="attack">
<h2>Attack<a class="headerlink" href="#attack" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python attack.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input 1 / 20 for movielens, b for beauty, bd for dense beauty, g for games, s for steam and y for yoochoose: 1
Input model code, b for BERT, s for SASRec and n for NARM: n
Input GPU ID: 0
Already preprocessed. Skip preprocessing
Negatives samples exist. Loading.
Negatives samples exist. Loading.
Input white box model code, b for BERT, s for SASRec and n for NARM: n
{1: &#39;narm2narm_autoregressive4&#39;, 2: &#39;narm_black_box&#39;}
Input index of desired white box model: 1
Already preprocessed. Skip preprocessing
## Black-Box Targeted Test on Item 2459 ##
Val: R@1 0.159, R@5 0.525, R@10 0.732, N@5 0.345, N@10 0.412: 100% 48/48 [00:01&lt;00:00, 24.67it/s]
## Targeted Attack on Item 2459 ##
  0% 0/48 [00:00&lt;?, ?it/s]/content/RecSys-Extraction-Attack/adversarial/attacker.py:82: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  perturbed_seqs = torch.cat((perturbed_seqs, torch.tensor(append_items).to(self.device)), 1)
Val: R@1 0.969, R@5 1.000, R@10 1.000, N@5 0.988, N@10 0.988: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 1009 ##
Val: R@1 0.061, R@5 0.254, R@10 0.432, N@5 0.158, N@10 0.215: 100% 48/48 [00:01&lt;00:00, 29.95it/s]
## Targeted Attack on Item 1009 ##
Val: R@1 0.972, R@5 1.000, R@10 1.000, N@5 0.990, N@10 0.990: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 2135 ##
Val: R@1 0.040, R@5 0.188, R@10 0.339, N@5 0.112, N@10 0.161: 100% 48/48 [00:01&lt;00:00, 30.28it/s]
## Targeted Attack on Item 2135 ##
Val: R@1 0.881, R@5 0.999, R@10 1.000, N@5 0.952, N@10 0.952: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 918 ##
Val: R@1 0.026, R@5 0.102, R@10 0.195, N@5 0.063, N@10 0.093: 100% 48/48 [00:01&lt;00:00, 30.40it/s]
## Targeted Attack on Item 918 ##
Val: R@1 0.916, R@5 1.000, R@10 1.000, N@5 0.967, N@10 0.967: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 3233 ##
Val: R@1 0.081, R@5 0.197, R@10 0.311, N@5 0.140, N@10 0.177: 100% 48/48 [00:01&lt;00:00, 30.01it/s]
## Targeted Attack on Item 3233 ##
Val: R@1 0.984, R@5 1.000, R@10 1.000, N@5 0.994, N@10 0.994: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 1226 ##
Val: R@1 0.011, R@5 0.088, R@10 0.198, N@5 0.048, N@10 0.083: 100% 48/48 [00:01&lt;00:00, 29.97it/s]
## Targeted Attack on Item 1226 ##
Val: R@1 0.812, R@5 1.000, R@10 1.000, N@5 0.927, N@10 0.927: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 498 ##
Val: R@1 0.008, R@5 0.048, R@10 0.098, N@5 0.028, N@10 0.044: 100% 48/48 [00:01&lt;00:00, 29.49it/s]
## Targeted Attack on Item 498 ##
Val: R@1 0.908, R@5 0.999, R@10 1.000, N@5 0.964, N@10 0.964: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 2917 ##
Val: R@1 0.011, R@5 0.054, R@10 0.113, N@5 0.032, N@10 0.051: 100% 48/48 [00:01&lt;00:00, 30.04it/s]
## Targeted Attack on Item 2917 ##
Val: R@1 0.967, R@5 1.000, R@10 1.000, N@5 0.987, N@10 0.987: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 1332 ##
Val: R@1 0.016, R@5 0.055, R@10 0.107, N@5 0.034, N@10 0.051: 100% 48/48 [00:01&lt;00:00, 29.70it/s]
## Targeted Attack on Item 1332 ##
Val: R@1 0.978, R@5 1.000, R@10 1.000, N@5 0.992, N@10 0.992: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 3184 ##
Val: R@1 0.004, R@5 0.039, R@10 0.078, N@5 0.020, N@10 0.033: 100% 48/48 [00:01&lt;00:00, 29.88it/s]
## Targeted Attack on Item 3184 ##
Val: R@1 0.733, R@5 0.996, R@10 0.999, N@5 0.887, N@10 0.888: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 264 ##
Val: R@1 0.005, R@5 0.026, R@10 0.057, N@5 0.015, N@10 0.025: 100% 48/48 [00:01&lt;00:00, 30.02it/s]
## Targeted Attack on Item 264 ##
Val: R@1 0.656, R@5 0.983, R@10 0.999, N@5 0.843, N@10 0.849: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 2490 ##
Val: R@1 0.007, R@5 0.058, R@10 0.132, N@5 0.031, N@10 0.055: 100% 48/48 [00:01&lt;00:00, 30.06it/s]
## Targeted Attack on Item 2490 ##
Val: R@1 0.811, R@5 1.000, R@10 1.000, N@5 0.927, N@10 0.927: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 1696 ##
Val: R@1 0.007, R@5 0.025, R@10 0.050, N@5 0.015, N@10 0.023: 100% 48/48 [00:01&lt;00:00, 29.92it/s]
## Targeted Attack on Item 1696 ##
Val: R@1 0.706, R@5 0.991, R@10 0.996, N@5 0.875, N@10 0.877: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 1448 ##
Val: R@1 0.004, R@5 0.020, R@10 0.070, N@5 0.012, N@10 0.027: 100% 48/48 [00:01&lt;00:00, 30.35it/s]
## Targeted Attack on Item 1448 ##
Val: R@1 0.651, R@5 0.976, R@10 0.998, N@5 0.836, N@10 0.844: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 144 ##
Val: R@1 0.000, R@5 0.010, R@10 0.028, N@5 0.005, N@10 0.011: 100% 48/48 [00:01&lt;00:00, 30.24it/s]
## Targeted Attack on Item 144 ##
Val: R@1 0.311, R@5 0.799, R@10 0.942, N@5 0.567, N@10 0.614: 100% 48/48 [01:42&lt;00:00,  2.13s/it]
## Black-Box Targeted Test on Item 365 ##
Val: R@1 0.000, R@5 0.008, R@10 0.031, N@5 0.004, N@10 0.011: 100% 48/48 [00:01&lt;00:00, 29.57it/s]
## Targeted Attack on Item 365 ##
Val: R@1 0.099, R@5 0.730, R@10 0.956, N@5 0.411, N@10 0.486: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 1368 ##
Val: R@1 0.006, R@5 0.024, R@10 0.041, N@5 0.015, N@10 0.021: 100% 48/48 [00:01&lt;00:00, 30.28it/s]
## Targeted Attack on Item 1368 ##
Val: R@1 0.700, R@5 0.992, R@10 0.999, N@5 0.871, N@10 0.873: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 2714 ##
Val: R@1 0.001, R@5 0.007, R@10 0.023, N@5 0.004, N@10 0.009: 100% 48/48 [00:01&lt;00:00, 30.18it/s]
## Targeted Attack on Item 2714 ##
Val: R@1 0.439, R@5 0.946, R@10 0.988, N@5 0.718, N@10 0.733: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 1874 ##
Val: R@1 0.001, R@5 0.007, R@10 0.019, N@5 0.004, N@10 0.008: 100% 48/48 [00:01&lt;00:00, 30.28it/s]
## Targeted Attack on Item 1874 ##
Val: R@1 0.713, R@5 0.998, R@10 0.999, N@5 0.884, N@10 0.885: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 3285 ##
Val: R@1 0.000, R@5 0.010, R@10 0.030, N@5 0.005, N@10 0.011: 100% 48/48 [00:01&lt;00:00, 30.42it/s]
## Targeted Attack on Item 3285 ##
Val: R@1 0.536, R@5 0.990, R@10 1.000, N@5 0.796, N@10 0.800: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 2235 ##
Val: R@1 0.001, R@5 0.009, R@10 0.022, N@5 0.005, N@10 0.009: 100% 48/48 [00:01&lt;00:00, 30.27it/s]
## Targeted Attack on Item 2235 ##
Val: R@1 0.321, R@5 0.861, R@10 0.935, N@5 0.612, N@10 0.636: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 3406 ##
Val: R@1 0.002, R@5 0.014, R@10 0.035, N@5 0.008, N@10 0.015: 100% 48/48 [00:01&lt;00:00, 30.13it/s]
## Targeted Attack on Item 3406 ##
Val: R@1 0.982, R@5 1.000, R@10 1.000, N@5 0.993, N@10 0.993: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 3155 ##
Val: R@1 0.000, R@5 0.005, R@10 0.015, N@5 0.002, N@10 0.006: 100% 48/48 [00:01&lt;00:00, 29.84it/s]
## Targeted Attack on Item 3155 ##
Val: R@1 0.450, R@5 0.970, R@10 0.997, N@5 0.738, N@10 0.747: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 1322 ##
Val: R@1 0.000, R@5 0.000, R@10 0.001, N@5 0.000, N@10 0.001: 100% 48/48 [00:01&lt;00:00, 30.48it/s]
## Targeted Attack on Item 1322 ##
Val: R@1 0.032, R@5 0.263, R@10 0.539, N@5 0.143, N@10 0.231: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
## Black-Box Targeted Test on Item 2928 ##
Val: R@1 0.000, R@5 0.000, R@10 0.002, N@5 0.000, N@10 0.001: 100% 48/48 [00:01&lt;00:00, 30.42it/s]
## Targeted Attack on Item 2928 ##
Val: R@1 0.001, R@5 0.014, R@10 0.039, N@5 0.007, N@10 0.015: 100% 48/48 [01:41&lt;00:00,  2.12s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!zip -r wb_model_narm_ml1m.zip ./experiments
!cp wb_model_narm_ml1m.zip /content/drive/MyDrive/TempData
!ls /content/drive/MyDrive/TempData
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="retrain">
<h2>Retrain<a class="headerlink" href="#retrain" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python retrain.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input 1 / 20 for movielens, b for beauty, bd for dense beauty, g for games, s for steam and y for yoochoose: 1
Input model code, b for BERT, s for SASRec and n for NARM: n
Input GPU ID: 0
Already preprocessed. Skip preprocessing
Negatives samples exist. Loading.
Negatives samples exist. Loading.
Input white box model code, b for BERT, s for SASRec and n for NARM: n
{1: &#39;narm2narm_autoregressive4&#39;, 2: &#39;narm_black_box&#39;}
Input index of desired white box model: 1
Already preprocessed. Skip preprocessing
## Generate Biased Data with Target [2459, 1009, 2135, 918, 3233, 1226, 498, 2917, 1332, 3184, 264, 2490, 1696, 1448, 144, 365, 1368, 2714, 1874, 3285, 2235, 3406, 3155, 1322, 2928] ##
Generating poisoned dataset...
100% 2/2 [00:04&lt;00:00,  2.24s/it]
Already preprocessed. Skip preprocessing
Negative samples don&#39;t exist. Generating.
Sampling negative items randomly...
100% 6100/6100 [00:01&lt;00:00, 6058.91it/s]
Negative samples don&#39;t exist. Generating.
Sampling negative items randomly...
100% 6100/6100 [00:01&lt;00:00, 5976.19it/s]
## Biased Retrain on Item [2459, 1009, 2135, 918, 3233, 1226, 498, 2917, 1332, 3184, 264, 2490, 1696, 1448, 144, 365, 1368, 2714, 1874, 3285, 2235, 3406, 3155, 1322, 2928] ##
Epoch 1, loss 5.217 : 100% 7761/7761 [11:15&lt;00:00, 11.49it/s]
Eval: N@1 0.474, N@5 0.629, N@10 0.657, R@1 0.474, R@5 0.760, R@10 0.847: 100% 48/48 [00:01&lt;00:00, 29.43it/s]
Update Best NDCG@10 Model at 1
Epoch 2, loss 5.196 : 100% 7761/7761 [11:15&lt;00:00, 11.48it/s]
Eval: N@1 0.477, N@5 0.632, N@10 0.658, R@1 0.477, R@5 0.764, R@10 0.845: 100% 48/48 [00:01&lt;00:00, 29.73it/s]
Update Best NDCG@10 Model at 2
Epoch 3, loss 5.186 : 100% 7761/7761 [11:15&lt;00:00, 11.48it/s]
Eval: N@1 0.476, N@5 0.634, N@10 0.661, R@1 0.476, R@5 0.766, R@10 0.847: 100% 48/48 [00:01&lt;00:00, 29.53it/s]
Update Best NDCG@10 Model at 3
Epoch 4, loss 5.178 : 100% 7761/7761 [11:16&lt;00:00, 11.47it/s]
Eval: N@1 0.474, N@5 0.632, N@10 0.659, R@1 0.474, R@5 0.763, R@10 0.846: 100% 48/48 [00:01&lt;00:00, 29.71it/s]
Epoch 5, loss 5.171 : 100% 7761/7761 [11:16&lt;00:00, 11.47it/s]
Eval: N@1 0.468, N@5 0.629, N@10 0.655, R@1 0.468, R@5 0.764, R@10 0.845: 100% 48/48 [00:01&lt;00:00, 29.76it/s]
Epoch 6, loss 5.165 : 100% 7761/7761 [11:17&lt;00:00, 11.45it/s]
Eval: N@1 0.475, N@5 0.635, N@10 0.660, R@1 0.475, R@5 0.769, R@10 0.848: 100% 48/48 [00:01&lt;00:00, 29.76it/s]
Epoch 7, loss 5.139 :  37% 2903/7761 [04:13&lt;07:03, 11.46it/s]
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sparsh-ai/recsys-attacks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="T711285_Data_Poisoning_Attack_using_LFM_and_ItemAE_on_Synthetic_Dataset.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Data Poisoning Attack using LFM and ItemAE on Synthetic Dataset</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="T355514_Black_box_Attack_on_Sequential_Recs.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Black-box Attack on Sequential Recs</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Sparsh A.<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>